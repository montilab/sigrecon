% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/util.R
\name{sig_filter_fn}
\alias{sig_filter_fn}
\title{Filter Significant Genes by Perturbation}
\usage{
sig_filter_fn(
  diff_table,
  perts,
  alpha = 0.05,
  limit = 100,
  pert_col = "product",
  log2fc_col = "avg_log2FC",
  pval_col = "p_val_adj",
  geneid_col = "ensembl_id"
)
}
\arguments{
\item{diff_table}{A data frame containing differential expression results with
perturbation identifiers, log2 fold changes, and adjusted p-values.}

\item{perts}{A character vector of perturbation names to filter for.}

\item{alpha}{Numeric. Adjusted p-value threshold for significance. Default is 0.05.}

\item{limit}{Integer. Maximum number of top significant genes to return per
perturbation. Default is 100.}

\item{pert_col}{Character. Name of the column containing perturbation identifiers.
Default is "product".}

\item{log2fc_col}{Character. Name of the column containing log2 fold change values.
Default is "avg_log2FC".}

\item{pval_col}{Character. Name of the column containing adjusted p-values.
Default is "p_val_adj".}

\item{geneid_col}{Character. Name of the column containing gene identifiers.}
}
\value{
A nested list where each perturbation contains:
\itemize{
\item{\code{up}}: Character vector of row names for top significantly
upregulated genes (filtered by alpha and limited by limit parameter)
\item{\code{up_full}}: Character vector of row names for all genes ranked
by combined score (log2FC * -log10(p_val_adj))
}
}
\description{
Filters and ranks genes by significance for each perturbation in a differential
expression table. Returns both all genes ranked by a combined score and
significantly up-regulated genes that pass thresholds.
}
\details{
The function computes a combined significance score as:
\deqn{score = log2FC \times -log10(p_{adj})}

For the "up" results, genes must meet three criteria:
\enumerate{
\item log2FC > 0 (upregulated)
\item adjusted p-value <= alpha
\item Ranked in top N genes (specified by limit)
}
}
